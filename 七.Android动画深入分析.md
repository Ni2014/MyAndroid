#《Android开发艺术探索》读书笔记
#第七章 Android动画深入分析
	
Android动画可以分为3种：View动画，帧动画和属性动画。帧动画也属于View动画的一种，只是他和平移，旋转等常见的View动画在表现形式上略有不同而已View动画通过对场景里的对象不断对对象变换(平移，缩放，旋转，透明度)从而产生动画效果，是一种渐近式动画，并且View动画支持自定义。帧动画通过顺序播放一系列图像从而产生动画效果，可以简单理解为图片切换动画，显然，如果图片过多过大就会导致OOM。属性动画通过动态改变对象的属性从而达到动画效果，属性动画是Api11的新特性，在低版本中无法使用属性动画，但是可以通过兼容库来使用他。<br>
##7.1 View动画
View动画的作用对象是View，支持4种动画效果，分别是平移动画，缩放动画，旋转动画和透明度动画。
###7.1.1 View动画的种类
View动画的四种变换效果对应着Animation的四个子类：TranslateAnimation，ScaleAnimation，RotateAnimation和AlphaAnimation，这四种动画既可以通过XML来定义，也可以通过代码来动态创建，对于View动画来说，建议采用XML来定义动画，因为XML格式的动画可读性更好。<br>
①平移动画<br>
标签：<translate>，子类：TranslateAnimation，效果：移动View<br>
②缩放动画<br>
标签：<scale>，子类：ScaleAnimation，效果：放大或缩小View<br>
③旋转动画<br>
标签：<rotate>，子类：RotateAnimation，效果：旋转View<br>
④透明度动画<br>
标签：<alpha>，子类：AlphaAnimation，效果：改变View的透明度<br>
要使用View动画，先创建动画的XML文件，路径是：res/anim/filename.xml,有固定的语法，View动画可以是单个动画也可以是一系列动画组成。<br>
<set>标签表示动画集合，对应AnimationSet类，可以包含若干个动画，并且他的内部可以嵌套其他动画集合，两个属性的含义如下：<br>
(1)android:interpolator<br>
表示动画集合所采用的插值器，插值器影响动画的速度，比如非匀速动画就需要通过插值器来控制动画的播放过程。这个属性可以不指定，默认是@android:anim/accelerate_decelerate_interpolator,即加速减速插值器。<br>
(2)android:shareInterpolator<br>
表示集合中的动画是否和集合共享一个插值器。如果集合不指定插值器，那么子动画就需要单独指定所需的插值器或者使用默认值。<br>
<translate>标签表示平移动画，对应TranslateAnimation类，可以使一个View在水平或竖直方向上完成平移的动画效果，他的一系列属性的含义如下：<br>
①android:fromXDelta==>x的起始点，如0<br>
②android:toXDelta==>x的结束值，如100<br>
③android:fromYDelta==>y的起始点<br>
④android:toYDelta==>y的结束值<br>
<scale>表示缩放动画，属性如下：<br>
①android:fromXScale==>水平方向缩放的起始值<br>
②android:toXScale==>水平方向缩放的结束值<br>
③android:fromYScale==>竖直方向缩放的起始值<br>
④android:toYScale==>竖直方向缩放的结束值<br>
⑤android:pivotX==>缩放的轴点的x坐标，会影响缩放的效果<br>
⑥android:pivotY==>缩放的轴点的y坐标，会影响缩放的效果<br>
轴点的概念，默认情况下轴点是View的中心点。<br>
<rotate>表示旋转动画，属性如下：<br>
①android:fromDegress==>旋转开始的角度<br>
②android:toDegress==>旋转结束的角度<br>
③android:pivotX==>旋转的轴点的x坐标<br>
④android:pivotY==>旋转的轴点的y坐标<br>
在旋转动画中也有轴点的概念，默认情况下是View的中心点<br>
<alpha>标签表示透明度变化，属性如下：<br>
①android:fromAlpha==>透明度的起始值<br>
②android:toAlpha==>透明度的结束值<br>
除此之外，View动画还有些常用的属性：<br>
①android:duration==>动画的持续时间<br>
②android:fillAfter==>动画结束以后View是否停留在结束的位置，true表示停留<br>
###7.1.2 自定义View动画
简单：只需要继承Animation这个抽象类，重写他的initialize和applyTransformation方法，在initialize方法中做一些初始化工作，在applyTransformation方法中进行相应的矩阵变换，很多时候需要采用Camera来简化矩阵变换；<br>
复杂：涉及到矩阵变换，是数学上的东西；<br>
###7.1.3 帧动画
类似于电影播放，不同于View动画，系统提供了另外一个类AnimationDrawable来使用帧动画，使用简单。<br>
##7.2 View动画的特殊使用场景
View动画除了上述的四种形式外，还可以在一些特殊的场景下使用，比如在ViewGroup中可以控制子元素的出场效果，在Activity中可以实现不同Activity之间的切换效果。<br>
###7.2.1 LayoutAnimation
作用于ViewGroup,为ViewGroup指定一个动画，这样当他的子元素出场的时候都会具有这种动画效果，常常用在ListView上面。<br>
###7.2.2 Activity的切换效果
Activity有默认的切换效果，但是这个效果是可以我们自定义的，主要用到了overridePendingTransition(int enterAnim,int exitAnim)这个方法，这个方法必须在startActivity或者finish之后被调用才能生效，两个参数分别代表Activity被打开和暂停时所需的动画资源id。<br>
##7.3 属性动画
属性动画是API11新加入的特性，和View动画不同，他对作用对象进行了扩展，属性动画可以对任何对象做动画，甚至还可以没有对象。另外效果也做了加强，不再像View动画那样只能支持四种简单的变换。属性动画中有ValueAnimation，ObjectAnimation和AnimationSet等概念，可以实现绚丽的的动画。<br>
###7.3.1 使用属性动画
属性动画可以对任何对象的属性进行动画而不仅仅是View，动画默认时间间隔300ms，默认帧率10ms/帧，其可以达到的效果是：在一个时间间隔内完成一个对象属性值到另一个属性值的改变。所以，属性动画几乎是无所不能的，只要对象有这个属性，都能实现动画效果。但是属性动画是从API11才有，严重制约了属性动画的使用，可以采用开源动画库nineoldandroids来兼容以前的版本。<br>
常用的有ValueAnimation，ObjectAnimation和AnimationSet，ObjectAnimation继承自ValueAnimation，AnimationSet是动画集合，可以定义一组动画。<br>
###7.3.2 理解插值器和估值器
TimeInterpolator翻译为时间插值器，作用是根据时间流逝的百分比来计算出当前属性值改变的百分比，系统预置有LinearInterpolator(线性插值器：匀速动画)，AccelerateDecelerateInterpolator(加速减速插值器：动画两头慢中间快)和DecelerateInterpolator(减速插值器：动画越来越慢)<br>
TypeEvaluator是类型估值算法也叫估值器，系统预置的有IntEvaluator(针对整型属性)，FloatEvaluator(针对浮点型属性)，ArgbEvaluator(针对color属性)；<br>
###7.3.3 属性动画的监听器
###7.3.4 对任意属性做动画
###7.3.5 属性动画的工作原理
##7.4 使用动画的注意事项
1 OOM问题<br>
主要出现在帧动画中，当图片较多且较大时就很容易出现OOM，尽量避免使用帧动画；<br>
2 内存泄漏<br>
在属性动画中有一类无限循环的动画，这类动画在Activity退出时要及时停止，否则就会导致Activity无法释放造成内存泄漏，而View动画不存在这个问题；<br>
3 兼容性问题<br>
动画在3.0以下的系统上有兼容性问题；<br>
4 View动画的问题<br>
View动画是对View的影响做动画，并不是真正的去改变View的状态，所以有时候会出现动画完成后View无法隐藏的现象，即setVisibility(View.GONE)失效了，此时调用下view.clearAnimation()清除View动画就可解决。<br>
5 不要使用px<br>
尽量用dp，用px的话在不同屏幕有不同的效果；<br>
6 动画元素的交互<br>
将View平移后，在3.0以前的系统上，不管是View动画还是属性动画，新位置均无法触发单击事件，同时老位置可以触发单击事件。尽管View在视觉上不存在了，将View移回原位置后，原位置的单击事件继续生效。从3.0开始，属性动画的单击事件触发位置为移动后的位置，但是View动画仍然在原位置；<br>
7 硬件加速<br>
建议开启硬件加速，这样会提高动画的流畅性；<br>