#《Android开发艺术探索》读书笔记
#第十五章  Android性能优化
##15.1 Android的性能优化方法
###15.1.1 布局优化
	
思想较简单，就是尽量减少布局文件的层级，层级少==>绘制的工作量少==>性能提高；<br>
	方式：①合理选择ViewGroup;②采用<include>,<merge>标签和ViewStub。<br><include>侧重于布局重用，<merge>一般和<include>配合使用，ViewStub提供了按需加载的功能；<br>
	ViewStub继承了View，非常轻量级且宽高都是0，所以它本身不参与任何的布局和绘制过程，目前ViewStub不支持<merge>标签；<br>
###15.1.2 绘制优化
	
指的是View的onDraw方法要避免执行大量的操作；<br>
	①onDraw中不要创建新的局部对象，因为onDraw方法可能被频繁调用，会在一瞬间产生大量的临时对象，占用大量的内存同时导致系统频繁gc，降低程序的执行效率；<br>
	②onDraw方法中不要做耗时的操作，也不能执行成千上万次的循环操作，虽然每次的循环都很轻量级，但是大量的循环仍然十分抢占cpu的时间片，会造成View绘制过程中的不流畅；<br>
###15.1.3 内存泄漏优化
	
场景1:静态变量导致的内存泄漏；<br>
	 比如一个静态的变量引用了Activity，将会导致这个Activity无法被回收；<br>
	场景2:单例模式导致的内存泄漏；<br>
	如果Activity被单例模式的对象持有的话也会导致这个Activity无法被回收，因为单例模式的特点是生命周期和Application保持一致；<br>
	场景3:属性动画导致的内存泄漏；<br>
	属性动画是Android3.0开始提供的，属性动画有一类无限循环的动画，如果在Activity中播放此类动画且没有在onDestory中去停止动画(animator.cancle())，那么动画会一直播放下去，这个时候Activity的View会被动画持有，但是View又持有了Activity，导致Activity无法释放。<br>
###15.1.4 响应速度优化和ANR日志分析
	
响应速度优化的核心是避免在主线程中做耗时操作，响应速度慢更多体现在Activity的启动速度上，ANR问题难定位。怎么定位呢？<br>
	当一个进程发生ANR后，系统会在/data/anr目录下创建一个trace.txt，分析这个文件就能定位出ANR的原因。<br>
###15.1.5 ListView和Bitmap优化
	
简单说ListView的优化就是：①采用ViewHolder避免在getView中执行耗时操作；②根据列表的滑动状态来控制任务的执行频率，比如快速滑动时就不适合开启大量的异步任务；③可以尝试开启硬件加速来使ListView的滑动更加流畅，这些优化策略完全适用于GridView；<br>
	
Bitmap的优化主要通过BitmapFactory.	Options来根据需要对图片进行采样，采样过程中遇到了BitmapFactory.	Options的inSampleSize参数；<br>
###15.1.6 线程优化
	
思想是采用线程池，避免程序中存在大量的Thread，线程池可以重用内部的线程，从而避免了线程的创建和销毁所带来的性能开销，同时线程池还能有效的控制线程并发数，避免大量的线程因相互抢占系统资源导致阻塞现象的发生。<br>
###15.1.7 性能优化的建议
	
①避免创建过多的对象；<br>
	②不要过多使用枚举，枚举占用的内存比整型要大；<br>
	③常量用static fianl修饰；<br>
	④使用一些Android特有的数据结构，比如SparseArray和Pair等，他们具有更好的性能；<br>
	⑤适当使用弱引用和软引用；<br>
	⑥采用内存缓存和磁盘缓存；<br>
	⑦尽量采用静态内部类，可以避免潜在的由于内部类而导致的内存泄漏；<br>
##15.2 内存泄漏分析之MAT工具
##15.3 提高程序的可维护性
(1)命名要规范，少用缩写，私有成员m开头，静态成员s开头；<br>
(2)代码的排版要留出合适的空白来区分不同的代码块；<br>
(3)仅为非常关键的代码加注释，这对变量和方法的命名风格提出了很高的要求；<br>
代码的层次性是指代码要有分层的概念；<br>
程序的扩展性标志着开发者是否有足够的经验；<br>
适当使用设计模式可以提高代码的可维护性和可扩展性
